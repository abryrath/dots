#!/usr/bin/env bash

usage() { echo "Usage: $0 [-h] [-u <user>]" 1>&2; exit 1; }

while getopts ":u:" o; do
    case "${o}" in
        u)
            u=${OPTARG}
            ;;
        *)
            usage
            ;;
    esac
done

shift $((OPTIND-1))

if [ -z "${u}" ]; then
    u="abryrath@vivaldi.net"
elif [ $u == "union" ]; then 
    u="abryrathunion@vivaldi.net"
fi

echo "User: ${u}"

case "${u}" in
    abryrath@vivaldi.net)
        dataDir=""
        # $HOME/.vivaldi/abryrath-vivaldi-net"
        ;;
    abryrathunion@vivaldi.net)
        d="$HOME/.vivaldi/abryrathunion-vivaldi-net"
        if [ ! -d "${d}" ]; then mkdir -p "${d}"; fi
        dataDir="--user-data-dir=${d}"
        ;;
esac

echo "Data Dir: ${dataDir}"
        

case $(uname -s) in
    Darwin)
        executable="/Applications/Vivaldi.app/Contents/MacOS/Vivaldi"
        ;;
    *)
        executable=$(which vivaldi)
        ;;
esac

if [ -z "${executable}" ]; then
    ehco "Could not locate executable";
    exit 1;
fi

eval "${executable} ${dataDir}"