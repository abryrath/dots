var globalNewNotifMetadata={},globalIncomingMsgThreadNotifDetailsObj={},socket,globalHaveCalledProcessPhoneStatusThisSession=!1;
function _f7f5d29e57d96e6a8c4b85b3593e810d83b3fc28(){var a=((new Date).getTime()-webapp_crx_time_last_successful_health_check_received.getTime())/1E3;_5276b5584e6156b37336e226a43b1ad6e8a70810("Seconds Since LAST SUCCESSFUL INCOMING PUSH: "+_c717c8186fe68f520941370a68c7d57aeb26e6d9(a,2)+"secs ("+_c717c8186fe68f520941370a68c7d57aeb26e6d9(a/60,2)+" minutes)");300<a&&_ff68449349c716039c3cf762d1c709202da1fcf1();480<a?(_5276b5584e6156b37336e226a43b1ad6e8a70810("ALERT! has been > 8 minutes since last incoming PUSH. Will RESTART CRX in 5 seconds . . ."),
window.setTimeout(function(){_1c44fb4dd48d453d8f5dbe5e058ac3fc96cb7789("Push-Socket-Error")},5E3)):_5276b5584e6156b37336e226a43b1ad6e8a70810("----- has NOT been > 8 minutes since last incoming PUSH -- OK")}
function _ff68449349c716039c3cf762d1c709202da1fcf1(){console.log(" ");console.log("------------------------------------------------ NEW POLL - HealthCheckPUSH -----------------------------------");console.log("webapp-loop at: "+Date()+" for user email -> "+google_username_currently_logged_in);body_text_to_send="CAPI_HEALTH_CHECK_FROM_CRX -- "+(new Date).getTime().toString();$.ajax({url:baseUrl+"/test?function=capi&body="+body_text_to_send+"&phone_num=123456789",type:"POST",dataType:"text",success:function(a){console.log(a);
time_last_success_mighty_ping=new Date;-1!=a.search("user not logged in")?(console.log("User is not logged in to MightyText"),_40421d6eb1a359f2f822a28b0f0f93da0d4bbf00("user-not-logged-in"),_cf94feae83b29d72ea66153ef1ea100664fbc29e(),"SIGNED_IN"==push_helper_global_login_state&&(_bb8e340c9454e1a89957aaef19ce60280313d3eb(),push_helper_global_login_state="SIGNED_OUT")):-1!=a.search("CAPI test sent successfully")&&(_40421d6eb1a359f2f822a28b0f0f93da0d4bbf00("user-logged-in"),push_helper_global_login_state=
"SIGNED_IN")}})}function _3508e249a7f2b6dae514b06f2467b28745bc2c3d(a){var b={};"undefined"!=typeof a&&"notif_options"in a&&(b=a.notif_options,"Mac"!=globalUserOS&&$.extend(b,{requireInteraction:!0}));return b}
function _ee13f699626cda3f1e12d4e2a779ccde9d557d04(a){userIsDefaultPushServiceCapable=!0;webapp_crx_time_last_successful_health_check_received=new Date;var b=!1,d=jQuery.parseJSON(a);if(void 0!==d.new_content){var c=d.new_content;if(!(-1<c.body.search("CAPI_HEALTH_CHECK")||-1<c.body.search("USER_UPDATED_SETTINGS_IN_WEBAPP"))){if(!_7b2c0da22646fcd76eed58b1a753d13903fa7880("message_notifications"))return!1;window.localStorage.notif_content&&"0"==window.localStorage.notif_content&&(b=!0);if(0==c.stale_notif_flag&&
61!=c.inbox_outbox&&84!=c.type&&85!=c.type){var f="",e="";a=_63844fc7c6db7790c91db338e0be6ac2f9ad2062(c.body);if(10==c.type){f="";e=a;var g="SMS"}else 11==c.type?void 0!==c.mms_object_key&&(f=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"pic_msg_from"})+" ",e=a,g="MMS"):20==c.type?(f=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"group_msg_from"})+" ",e=a,g="GroupText"):21==c.type?(f=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"group_pic_msg_from"})+" ",e=a,g="GroupPicText"):80==c.type?f=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"incoming_call_from"})+
" ":81==c.type&&(f=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"missed_call_from"})+" ");var h="";h=_2179e4e648b11e528a65b5e742682e4621eb0da4(c.phone_num_clean,c.phone_num);a=_f85c7f68371303b287423f34b3b4eb05f1c729c7(c.phone_num_clean,c.phone_num);var k=_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,10);"undefined"!=typeof g&&0===k&&_kmq.push(["record","Incoming-Message-10pct",{Type:g,Client:"CRX",incoming_message_crx_version:manifest.version}]);b&&void 0==c.enlargeMMSMode&&(e=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"click_to_see_message"})+
"...");window.localStorage.notif_auto_dismiss&&"1"==window.localStorage.notif_auto_dismiss&&(notif_dismissal_time=1E3*parseInt(window.localStorage.notif_auto_dismiss_time));"is_snoozed"in c||$.extend(c,{is_snoozed:!1});globalNewNotifMetadata[c.id]=c;g=f+h;f=e;h=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"reply"});if(20==c.type||21==c.type)a=_b64bdd522abebf44f807721875afe5597b86403d(c.content_author,!0),g=_2179e4e648b11e528a65b5e742682e4621eb0da4(a,c.content_author),a=_f85c7f68371303b287423f34b3b4eb05f1c729c7(a,
c.content_author),g=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"group_mms_from"})+"\r\n"+g,f=_2179e4e648b11e528a65b5e742682e4621eb0da4("N/A",c.phone_num),f=e+"\r\n\r\n("+f+")",h=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"reply_to_group"});e=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"remind_me_in"});k="../img/notifications/alarm_bell_snooze-48.png";if(10==c.type||20==c.type){var n=$.jStorage.get("mt_reminders_experiment","exp-flag-not-set"),l={msg_type:c.type};"exp-flag-not-set"!=n?(e=
_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"remind_me_in_new"}),k="../img/notifications/crx-reminder-inc-msg-snooze5.png",l.new_reminder_btn=!0):l.new_reminder_btn=!1;c.hasOwnProperty("msg_reminder")||_d5807d3d1a8ff7466ec43cdafce556cb79e048a7(l)}if(11==c.type||21==c.type)b||(a=baseUrl+"/imageserve?function=fetchFile&id="+c.id),e=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"view_full_pic"}),k="../img/notifications/photoview_32.png";20!=c.type&&11!=c.type&&21!=c.type||_3bfa46ab27ed26c59e174aab430c53e7f5716827({content_author:_b64bdd522abebf44f807721875afe5597b86403d(c.content_author,
!0)});if(80==c.type||81==c.type)h=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"send_text_msg"}),80==c.type?(e=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"decline_on_phone"}),k="../img/notifications/end_call_notif.png"):c.hasOwnProperty("missed_call_reminder")?f=c.body:81==c.type&&_d5807d3d1a8ff7466ec43cdafce556cb79e048a7({msg_type:c.type,new_reminder_btn:!1});var p={type:"basic",title:g,message:f,priority:2,eventTime:Date.now(),isClickable:!0,iconUrl:a,contextMessage:_4c34daf797c86e14f2e97c23ddc8cb1df7ea7d04(c.ts_server,
!0),buttons:[{title:h,iconUrl:"../img/notifications/new-reply-btn-icon.png"},{title:e,iconUrl:k}]};80!=c.type&&81!=c.type&&"Mac"!=globalUserOS&&(p.requireInteraction=!0);window.localStorage.hasOwnProperty("notif_auto_dismiss");if(void 0!==c.enlargeMMSMode)b=_3508e249a7f2b6dae514b06f2467b28745bc2c3d({notif_options:{type:"image",title:g,message:f,iconUrl:a,contextMessage:_4c34daf797c86e14f2e97c23ddc8cb1df7ea7d04(c.ts_server,!0),priority:2,eventTime:Date.now(),imageUrl:baseUrl+"/imageserve?function=fetchFile&id="+
c.id,buttons:[{title:h,iconUrl:"../img/notifications/new-reply-btn-icon.png"}]}}),chrome.notifications.create(c.id+"-picture",b,function(a){_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,notif_sound:!1});_9212dff23264fb334471e0b68e3abc18bbdfa581(a)});else{var q=c.id,r=$.extend({},p,{id:q,msg_id:c.id,is_snoozed:c.is_snoozed});_c4481051d69f7898ae6b4656c94d20a9ded33c94({msg:c,not_active_in_qr_callback:function(){_412158345a3b340d56f57bec88f156354f02c992({notif_details:r,create_notif_cb:function(){chrome.notifications.create(q,
p,function(a){_ee5f296bda9d62f84a36c523a88b6925d04dc809({origin:"new_chrome_notif_created",msg_type:c.type});_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Just created a Incoming Message Notif at: "+new Date+"with the ID "+a,"green");_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!0,notif_sound:!0})})},update_notif_cb:function(){_ee5f296bda9d62f84a36c523a88b6925d04dc809({origin:"incoming_sms_batched_in_chrome_notif",msg_type:c.type})}})},active_in_qr_callback:function(){_ee5f296bda9d62f84a36c523a88b6925d04dc809({origin:"user_active_in_qr_window_with_this_contact",
msg_type:c.type})}})}}}}else if(void 0!==d.phone_status){a=d.phone_status;e="";b=Math.floor(a.battery_level);g=a.battery_is_charging;f=((new Date).getTime()-parseInt($.jStorage.get("ts_last_battery_alert_notif_shown",0)))/1E3;chrome.runtime.sendMessage({phoneStatus:a},function(a){console.log(a)});_966179f0f3a24618024452b75c125d2e128eb38f(a);console.log("Num seconds since last battery alert notification on this CRX: "+f);$.jStorage.set("latest_phone_status",a,{TTL:36E4});h=_7b2c0da22646fcd76eed58b1a753d13903fa7880("notif_battery_fully_charged");
k=_7b2c0da22646fcd76eed58b1a753d13903fa7880("notif_battery_low");if("true"==g&&0!=h)return console.log("phone is charging - no notification to consider, unless battery is at 100%"),99<b&&3600<f&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),e="(as of "+a+")"),b={type:"basic",title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"full_batt_notif_title"}),message:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"full_batt_notif_content"})+".\r\n\r\n\r\n"+e,priority:2,
eventTime:Date.now(),iconUrl:"../img/notifications/battery-full.png",buttons:[{title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"bat_notif_settings"}),iconUrl:"../img/notifications/settings.png"}]},a=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",a),a=_09a01a1a2aa9efc7e8b671f47aebf9e7ad0e17d1(4),chrome.notifications.create("notif-battery-full-"+a,b,function(a){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Just created a Batt Full at: "+new Date+"with the ID "+
a,"green");_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,notif_sound:!0})})),!1;"false"==g&&0!=k&&2700<f&&(10>=b||12==b||14==b||16==b)&&(void 0!==a.ts_phone_utc&&(a=a.ts_phone_utc/1E3,a=moment.unix(a).format("h:mm a"),e="(as of "+a+")"),b={type:"basic",title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"low_bat_notif_title"}),message:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"low_bat_notif_content"})+": "+b+"%  "+e,priority:2,eventTime:Date.now(),iconUrl:"../img/notifications/low_battery_48.png",
buttons:[{title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"bat_notif_settings"}),iconUrl:"../img/notifications/settings.png"}]},a=(new Date).getTime().toString(),$.jStorage.set("ts_last_battery_alert_notif_shown",a),a=_09a01a1a2aa9efc7e8b671f47aebf9e7ad0e17d1(4),chrome.notifications.create("notif-battery-low-"+a,b,function(a){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Just created a Batt Low at: "+new Date+"with the ID "+a,"green");_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,
notif_sound:!0})}))}else if(void 0!==d.ack_processed)b=d.ack_processed,0>b.status_route&&(console.log("message failed!"),console.log(b),a=b.body,e=b.phone_num_clean,e=_2179e4e648b11e528a65b5e742682e4621eb0da4(e,b.phone_num),globalNewNotifMetadata[b.id]=b,a=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"msg_send_failure"}).replace("%msg_body%",a).replace("%contact_name%",e),a=_3508e249a7f2b6dae514b06f2467b28745bc2c3d({notif_options:{type:"basic",title:"Warning",message:a,eventTime:Date.now(),iconUrl:"../img/notifications/error_icon.png"}}),
console.error("msg send fail notif",a),chrome.notifications.create("message-send-failure-"+b.id,a,function(a){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Just created a Message Failed Notif at: "+new Date+"with the ID "+a,"green");_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,notif_sound:!0})}));else if(void 0!==d.device_notification)b=d.device_notification,a=String(b.ts_post),console.log(b),deviceNotifManagerArray[a]={},deviceNotifManagerArray[a].package_name=b.package_name,
deviceNotifManagerArray[a].device_id=b.device_id,deviceNotifManagerArray[a].id=b.id,deviceNotifManagerArray[a].app_name=b.app_name,deviceNotifManagerArray[a].original_object=b,0!=_7b2c0da22646fcd76eed58b1a753d13903fa7880("phone_app_notifications")&&_0d0d7fc808fa8dc3f3fa9f5a5f34077681659df9(b);else if(void 0!==d.end_call_info)b=d.end_call_info,1E4<(new Date).getTime()-b.ts_ended_utc||(a={type:"basic",message:"",priority:2,eventTime:Date.now(),iconUrl:"../img/notifications/end_call_notif.png"},1==b.status?
a.title=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"call_declined"}):0==b.status?a.title=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"call_decline_error"}):-99==b.status&&(a.title=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"call_in_progress"}),a.iconUrl="../img/notifications/call_in_progress.png"),chrome.notifications.create("end-call-status"+b.ts_ended_utc,a,function(a){_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,notif_sound:!1})}));else if(void 0!==d.client_changed_login_state)console.log(d.client_changed_login_state),
setTimeout(function(){_6f927c3b054a2be004df39e7f4c5d8765a6babf5()},1E3);else if(void 0!=d.contact_photo_refreshed_from_phone)b=d.contact_photo_refreshed_from_phone.phone_num,e=_b64bdd522abebf44f807721875afe5597b86403d(b,"do_not_zeropad"),_737f2a042444e04636c24f976d65ef2d8c6e052d(b,e);else if(void 0!==d.generic_notification){var m={title:"MightyText",type:"basic",priority:2,iconUrl:"../img/48x48_MT_logo_boom_gradient_white.png"};$(d.generic_notification).each(function(a,b){var c=(new Date).getTime();
b.hasOwnProperty("subject")&&(b.hasOwnProperty("type")&&"-1"==b.type?(m.title=b.subject,c+="-msg-send-quota"):m.title=b.subject);var d=b.body.replace(/(< ?\/?br ?\/?>)+/,"\n");m.message=d;b.hasOwnProperty("additional_info")&&-1<b.additional_info.indexOf("show-pro-button")&&(m.buttons=[{title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"go_pro"}),iconUrl:"../img/notifications/go_pro.png"}]);chrome.notifications.create("generic-notif-"+c,m,function(a){_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,
auto_dismiss:!1,notif_sound:!0})})})}else if(d["contacts-names-update-complete"])_a90681619f2608f7eb4fda41e90a8564bc5410ab(),_1964eccb3fb4dd513a0b2980e5f15a4b7a4fc786(function(){_67e82b618d4c7cb75ec3ed03ddeab5c094c155d2();_9387abc66ab5752d7e106ec6c426f657050d2fb7()});else if(d.hasOwnProperty("reminder_id")){b=_7b2c0da22646fcd76eed58b1a753d13903fa7880("reminder_notif");if(!b)return!1;b=d.name;a=d.description;e=d.token_id;g={type:"basic",title:b,message:"",priority:2,iconUrl:"../img/notifications/reminder-crx-notif.png",
buttons:[{title:_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"reminder_snooze"}),iconUrl:"../img/notifications/crx-reminder-snooze.png"}]};50<b.length&&(g.title="Reminder",g.message=b);0<g.length&&(g.contextMessage=a);chrome.notifications.create("reminder-"+e,g,function(a){_d6b9fcb67a09bd160cbd5e5ba69e7eae5d02c6a7({notif_id:a,auto_dismiss:!1,notif_sound:!0});_079db443eb13ab98fe3008ffed7e4ef29fd249ed(d);globalNewNotifMetadata[a]=d})}else if(d.hasOwnProperty("event_update_notify")){b=_7b2c0da22646fcd76eed58b1a753d13903fa7880("event_update_notify");
if(!b)return!1;_4115576c32b3e49a80c8fba00a4e827b17cb770e({scheduled_msg_capi_info:d.event_update_notify})}else if(d.hasOwnProperty("media_uploaded")){b=_7b2c0da22646fcd76eed58b1a753d13903fa7880("media_uploaded");if(!b)return!1;_57ff0cd144f2ab2b33562a61b9db6fb1bb4e90ad({media_uploaded_info:d.media_uploaded})}else console.log("unknown incoming CAPI content")}
function _c4481051d69f7898ae6b4656c94d20a9ded33c94(a){"undefined"!=typeof a&&a.hasOwnProperty("msg")&&"object"==typeof a.msg&&a.hasOwnProperty("not_active_in_qr_callback")&&"function"==typeof a.not_active_in_qr_callback&&("mms_wakeup"in a.msg&&!0===a.msg.mms_wakeup&&11!=a.msg.type?a.not_active_in_qr_callback():chrome.windows.getLastFocused({populate:!0},function(b){var d=!0;if(!chrome.runtime.lastError&&b.hasOwnProperty("type")&&"popup"==b.type&&b.hasOwnProperty("tabs")&&"object"==typeof b.tabs&&
"focused"in b&&!0===b.focused){var c=a.msg.phone_num_clean;$(b.tabs).each(function(a,b){if(b.hasOwnProperty("url")){console.info("url found! "+b.url);var e=$.deparam(b.url);console.info("hash params obj",e);e.hasOwnProperty("thread_id")&&(console.info("thread ID found! "+e.thread_id),e.thread_id==c&&(console.info("thread ID's match! don't create a chrome notif!"),d=!1))}})}0!=d?a.not_active_in_qr_callback():"active_in_qr_callback"in a&&a.active_in_qr_callback()}))}
function _5c3e920b4ce48367e83e8dc0ffca15e2927f2bf0(a){if("undefined"!=typeof a&&a.hasOwnProperty("notif")){var b=a.notif,d=b.phone_num_clean;if(!(d in globalIncomingMsgThreadNotifDetailsObj))$.extend(b,{num_msgs_grouped_in_notif:1,msg_ids_of_grouped_msgs:[b.id]}),globalIncomingMsgThreadNotifDetailsObj[d]=[b];else if("new_notif_created"in a||"msg_type"in b&&_e6a9a0b7a1291e214a985ef30c5c9472505a028c({type:b.msg_type}))$.extend(b,{num_msgs_grouped_in_notif:1,msg_ids_of_grouped_msgs:[b.id]}),globalIncomingMsgThreadNotifDetailsObj[d].push(b);
else if(d in globalIncomingMsgThreadNotifDetailsObj){a=globalIncomingMsgThreadNotifDetailsObj[d][globalIncomingMsgThreadNotifDetailsObj[d].length-1];var c=a.num_msgs_grouped_in_notif,f=a.msg_ids_of_grouped_msgs;d=a.message+("\n"+b.message);newNumMsgsGrouped=c+1;f.push(b.id);globalNewNotifMetadata[a.id].body=d;$.extend(a,{message:d,ts_notif_updated:b.ts_notif_updated,num_msgs_grouped_in_notif:newNumMsgsGrouped,msg_ids_of_grouped_msgs:f})}}}
function _e6a9a0b7a1291e214a985ef30c5c9472505a028c(a){var b=!1;"undefined"!=typeof a&&"type"in a&&-1<[11,21].indexOf(a.type)&&(b=!0);return b}function _cd2398190c5bf88c9d5f2831ecbce14f58ca8ad4(a){var b=!1;"undefined"!=typeof a&&"type"in a&&-1<[80,81,83,84,85].indexOf(a.type)&&(b=!0);return b}
function _1d1c3d60515c94e2d6cbdea7dc4db9f4df003fe6(a){if("undefined"!=typeof a&&"phone_num_clean"in a&&"msg_id"in a){var b=a.phone_num_clean;b in globalIncomingMsgThreadNotifDetailsObj&&$(globalIncomingMsgThreadNotifDetailsObj[b]).each(function(d,c){"msg_id"in c&&c.msg_id==a.msg_id&&(globalIncomingMsgThreadNotifDetailsObj[b].splice(d,1),0===globalIncomingMsgThreadNotifDetailsObj[b].length&&delete globalIncomingMsgThreadNotifDetailsObj[b])})}}
function _1712041d5e44312f3047c144b3393f0640001ee7(){webapp_crx_time_last_successful_health_check_received=new Date}
function _e8210ee38364fef152ac7f0e7aaf4c3dfe426224(a,b){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("inside of getRefreshedContactPhotoAndSaveToDom.  We are getting a new contact photo for the full num: "+b);var d="phone_num_clean="+a+"&phone_num_full="+encodeURIComponent(b);$.ajax({url:baseUrl+"/phonecontact?function=getPhoneContactPhotos",data:d,type:"POST",dataType:"json",success:function(b){$.jStorage.set(username_prefix_jstrg_purpose+"|PH_PIC_"+a,{contactThumbnailBinary:b.phone_contact_photo_status},
{TTL:12096E5})},error:function(a){}})}function _079db443eb13ab98fe3008ffed7e4ef29fd249ed(a){$.ajax({url:a.callback_url,type:"POST",data:{action:"delivered",token_id:a.token_id},dataType:"json",success:function(a){console.info(a)},complete:function(a,d){console.info("request to update complete! status: "+d)}})}
function _d5807d3d1a8ff7466ec43cdafce556cb79e048a7(a){if("undefined"!=typeof a&&a.hasOwnProperty("new_reminder_btn")){var b="-Legacy";0!=a.new_reminder_btn&&(b="-New-Reminder-Btn");10>_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,100)&&_kmq.push(["record","Incoming-Message-Notif-Shown"+b+"-10-PCT-Sample",{incoming_msg_notif_type:a.msg_type}])}}
function _966179f0f3a24618024452b75c125d2e128eb38f(a){if(globalHaveCalledProcessPhoneStatusThisSession)return!1;globalHaveCalledProcessPhoneStatusThisSession=!0;a.android_version&&(Intercom("update",{android_version:a.android_version}),5>_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,100)&&_gaq.push(["_trackEvent","Tracker","Android-Version-5pct-Sample",a.android_version]));if(a.android_version&&0==a.android_version.indexOf("4.4")||0==a.android_version.indexOf("4.3")||0==a.android_version.indexOf("5.0")||
0==a.android_version.indexOf("5.1"))$.jStorage.set("android_4.3_or_higher",a.android_version),a.notif_listen_enabled&&(5>_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,100)&&_gaq.push(["_trackEvent","Tracker","Notif-Listen-Enabled-5pct-Sample",a.notif_listen_enabled]),"1"==a.notif_listen_enabled&&$.jStorage.set("notif_listen_on","1",{TTL:12096E5}))}
function _f85c7f68371303b287423f34b3b4eb05f1c729c7(a,b){var d="../img/notifications/silhouette.jpg",c=$.jStorage.get(username_prefix_jstrg_purpose+"|PH_PIC_"+a,"no-jstorage-val-found");"no-jstorage-val-found"==c?_737f2a042444e04636c24f976d65ef2d8c6e052d(b,a):"NO_PHOTO"!=c.contactThumbnailBinary&&2<c.contactThumbnailBinary.length&&(d="data:image/jpeg;base64,"+c.contactThumbnailBinary);return d}
function _4115576c32b3e49a80c8fba00a4e827b17cb770e(a){if("undefined"!=typeof a&&a.hasOwnProperty("scheduled_msg_capi_info")&&a.scheduled_msg_capi_info.hasOwnProperty("status")&&710===a.scheduled_msg_capi_info.status){var b=a.scheduled_msg_capi_info.ref_id;$.ajax({type:"POST",url:baseUrl+"/content?function=getMessageDetail",data:"id="+b,dataType:"json",timeout:8E3,success:function(d){console.info("Sent Scheduled Message Details ",d);d.hasOwnProperty("message")?_48b6cf213ae63d863e4e4138beeb1cb89e0dd6b7({scheduled_msg_info:d.message}):
console.error(new Date+" Could not find message details for ID: "+b," Full message details",a)},error:function(a,b,f){console.log("error in _4115576c32b3e49a80c8fba00a4e827b17cb770e:");console.log(a);console.log(b);console.log(f)}})}}
function _209e6fbd27ed850fd7e4d1b762fe7f57891ce0d2(a){if("undefined"!=typeof a&&a.hasOwnProperty("msg_details")){var b=a.msg_details;$.each(globalNewNotifMetadata,function(a,c){b.phone_num_clean==c.phone_num_clean&&chrome.notifications.clear(c.id,function(a){a&&_76f080df774ef5b85b56bd4ab92fec0004cc5081(c.body,c.phone_num_clean)})})}}function _4c91c1778d9f23e2321568b0e08df8583162a27d(){chrome.notifications.getAll(function(a){console.info(a)})}
function _412158345a3b340d56f57bec88f156354f02c992(a){if("undefined"!=typeof a&&"notif_details"in a&&"create_notif_cb"in a&&"function"==typeof a.create_notif_cb){var b=a.notif_details,d=globalNewNotifMetadata[a.notif_details.msg_id],c=d.phone_num_clean;$.extend(b,{phone_num_clean:c,msg_type:d.type});_e6a9a0b7a1291e214a985ef30c5c9472505a028c({type:b.msg_type})||_cd2398190c5bf88c9d5f2831ecbce14f58ca8ad4({type:b.msg_type})||"Mac"==globalUserOS?(_5c3e920b4ce48367e83e8dc0ffca15e2927f2bf0({notif:b}),a.create_notif_cb()):
chrome.notifications.getAll(function(f){var e=(new Date).getTime(),g={notif:$.extend(b,{ts_notif_updated:e})},h="",k=!1,n=0,l;$.each(f,function(a,d){if(a in globalNewNotifMetadata&&globalNewNotifMetadata[a].phone_num_clean==c){var e=globalIncomingMsgThreadNotifDetailsObj[c][globalIncomingMsgThreadNotifDetailsObj[c].length-1];_e6a9a0b7a1291e214a985ef30c5c9472505a028c({type:e.msg_type})||_cd2398190c5bf88c9d5f2831ecbce14f58ca8ad4({type:e.msg_type})?g.new_notif_created=!0:(h=e.message+"\n"+b.message,
"notif_content"in localStorage&&"0"==localStorage.getItem("notif_content")&&(h=_17b88bbdae4990e1a40e4c9175cb0cb5f572c185({key:"click_to_see_n_messages",placeholders:[e.num_msgs_grouped_in_notif+1]})),l=e.msg_id,n=e.ts_notif_updated,k=!0)}});!0===k?_5c7e4b956605a4f83ae801017638893928431b45({msg_body:h,notif_title:b.title})&&_6456e56fa4fed8bad28edbf8c13a680ece7b4684({current:e,past:n})&&!1===globalNewNotifMetadata[l].is_snoozed?chrome.notifications.update(l,{message:h,contextMessage:_4c34daf797c86e14f2e97c23ddc8cb1df7ea7d04(d.ts_server,
!0)},function(b){"update_notif_cb"in a&&a.update_notif_cb()}):(g.new_notif_created=!0,a.create_notif_cb()):a.create_notif_cb();_5c3e920b4ce48367e83e8dc0ffca15e2927f2bf0(g)})}}
function _5c7e4b956605a4f83ae801017638893928431b45(a){var b=!1;if("undefined"!=typeof a&&"msg_body"in a&&"notif_title"in a){var d=a.notif_title;a=a.msg_body.split(new RegExp(/\n/g));var c=180,f=0,e=c/5;if(30<d.length||d.match(/\n/g))c*=.6;$(a).each(function(a,b){f=b.length<=e?f+e:f+Math.ceil(b.length/e)*e});f<=c&&(b=!0)}return b}
function _6456e56fa4fed8bad28edbf8c13a680ece7b4684(a){var b=!1;if("undefined"!=typeof a&&"current"in a&&"past"in a){var d=moment(a.current);a=moment(a.past).add(2,"minutes");d.isBefore(a)&&(b=!0)}return b}function _3bfa46ab27ed26c59e174aab430c53e7f5716827(a){"undefined"!=typeof a&&a.hasOwnProperty("content_author")&&chrome.notifications.clear("incoming_mms_wakeup-"+a.content_author)}
function _ee5f296bda9d62f84a36c523a88b6925d04dc809(a){"undefined"!=typeof a&&"origin"in a&&"msg_type"in a&&10>_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,100)&&_kmq.push(["record","Incoming-Msg-Notif-Result-10-Pct-Sample",{incoming_msg_resulting_action:a.origin,incoming_msg_type:a.msg_type}])};