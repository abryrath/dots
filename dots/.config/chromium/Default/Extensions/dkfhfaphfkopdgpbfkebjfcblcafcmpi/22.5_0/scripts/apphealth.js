var ts_last_js_running=new Date,ts_last_internet_ping=new Date,remoteAssetToCheckForInHealthCheck="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js",globalShouldPerformGlobalAppHealthCheck=!0;
function _86320b50d311e34a4e3016275c8461f282d87f08(a,b){if(!globalShouldPerformGlobalAppHealthCheck)return!1;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Inside of _86320b50d311e34a4e3016275c8461f282d87f08.  Checking user internet connectivity.","green","14px");navigator.onLine?(_9a0163908ce63615194f3dfea7654ade892757e4({name:"internet-connection-check-before-ajax-network-OK"}),$.ajax({type:"GET",url:remoteAssetToCheckForInHealthCheck,timeout:5E3,cache:!1,dataType:"text",success:function(a){_334a684f47c8bc933dc45841452d012963f8045b();
_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("internet connection check succeeded: "+remoteAssetToCheckForInHealthCheck,"green","14px");_9a0163908ce63615194f3dfea7654ade892757e4({name:"internet-connection-check-SUCCESS"});b&&"navigator-online"==b&&(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("_86320b50d311e34a4e3016275c8461f282d87f08 triggered from navigator.onLine.  Current ts: "+new Date,"green","14px"),___getPhoneStatus(),_c85df22ff6163ebdfc2c78620e927b244399863b({get_latest_notifs_for_existing:!0}),
"CRX"==clientRunningScript&&_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("_86320b50d311e34a4e3016275c8461f282d87f08 triggered from navigator.onLine.  User is on CRX and previously established a PUSH socket. Checking PUSH Socket health now.","green","14px"),_e2740cc5aa57c15d66b867b7dfb165dd5ad7097f(0));"CRX"!=clientRunningScript?(_cecdda69027cb5c5be0e25f2ebe66b197cc292f6(),_d8628f2c97ee9dcadb19cd0f2b86b277a73019a5()):"undefined"!=typeof frdSocket&&(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("User is on CRX and have previously established a PUSH socket. Making sure browser action icon is set to teal and that they have context menus.",
"green","14px"),_40421d6eb1a359f2f822a28b0f0f93da0d4bbf00("user-logged-in"),_e9fc47ca6881a211416a531bba112a3430815a23())},error:function(){_d8628f2c97ee9dcadb19cd0f2b86b277a73019a5();_9a0163908ce63615194f3dfea7654ade892757e4({name:"internet-connection-check-ERROR"});a&&a()}})):(a&&a(),_d8628f2c97ee9dcadb19cd0f2b86b277a73019a5())}
function _643fc0591de8194e289b4a026a2d05934205e146(){if(!globalShouldPerformGlobalAppHealthCheck)return!1;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Setting listeners for user network events and global ajax methods.","blue","14px");window.addEventListener("online",function(){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("User gained network connection.","blue","14px");setTimeout(function(){_86320b50d311e34a4e3016275c8461f282d87f08(!1,"navigator-online");_9a0163908ce63615194f3dfea7654ade892757e4({name:"navigator-online-listener-triggered"})},
5E3)});window.addEventListener("offline",function(){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("User lost network connection.","blue","14px");_86320b50d311e34a4e3016275c8461f282d87f08(_d31e901ee1dacd5ab44a10f107019d9627e9155d)});$(document).ajaxSend(function(a,b){!1===navigator.onLine&&_d31e901ee1dacd5ab44a10f107019d9627e9155d()});$(document).ajaxSuccess(function(a,b){_334a684f47c8bc933dc45841452d012963f8045b()})}
function _61890e40034a84a1043da3ac61a0124a1a1506c9(){if(!globalShouldPerformGlobalAppHealthCheck)return!1;var a=ts_last_js_running;ts_last_js_running=new Date;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Inside of _61890e40034a84a1043da3ac61a0124a1a1506c9.  Checking user internet connectivity last confirmed ("+_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(ts_last_internet_ping)+" seconds ago) and js staleness ("+_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(a)+" seconds ago) (non CRX only)","purple","14px");
245<_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(ts_last_internet_ping)&&(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("It has been too long since ts_last_internet_ping was updated. Checking user internet connection","purple","14px"),_86320b50d311e34a4e3016275c8461f282d87f08(_d31e901ee1dacd5ab44a10f107019d9627e9155d),_9a0163908ce63615194f3dfea7654ade892757e4({name:"internet-connection-stale",label:_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(ts_last_internet_ping).toString()}));600<_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(a)&&
"CRX"!=clientRunningScript&&(_9a0163908ce63615194f3dfea7654ade892757e4({name:"js-stale-detected"}),_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("User has stale JS","purple","14px"),_86320b50d311e34a4e3016275c8461f282d87f08(),setTimeout(function(){_451417e78daa697a81adbde3361f5ea05af98b0b()},5500))}function _862d115d85cd013da03e0a7cf5a1e8c6a37be65a(a){return moment(new Date).diff(moment(a),"seconds")}
function _334a684f47c8bc933dc45841452d012963f8045b(){if(!globalShouldPerformGlobalAppHealthCheck)return!1;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Updating ts_last_internet_ping to: "+new Date,"blue","14px");ts_last_internet_ping=new Date}
function _451417e78daa697a81adbde3361f5ea05af98b0b(){if(!globalShouldPerformGlobalAppHealthCheck)return!1;if("CLASSIC"==threadDisplayModeGlobal||"POWERVIEW"==threadDisplayModeGlobal){var a=getLanguageSpecificText("stale_app_warning_1",globalDefaultLanguage)+" "+getLanguageSpecificText("stale_app_warning_2",globalDefaultLanguage)+' <span id="stale-js-warning-reload" onclick="location.reload()" class="app-health-warning-action-span">'+getLanguageSpecificText("stale_app_warning_3",globalDefaultLanguage)+
"</span>";6>_862d115d85cd013da03e0a7cf5a1e8c6a37be65a(ts_last_internet_ping)&&navigator.onLine&&(a=getLanguageSpecificText("stale_app_warning_1",globalDefaultLanguage)+'<br><br><span id="stale-js-warning-reload" onclick="location.reload()" class="app-health-warning-action-span">'+getLanguageSpecificText("click_to_reload",globalDefaultLanguage)+"</span>");$.each($("#stale-js-warning-reload"),function(){$(this).parent().siblings(".customClose").click()});displayAlertMessage(a,"error",6E5)}}
function _d31e901ee1dacd5ab44a10f107019d9627e9155d(){_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Determined that the user has no internet connection.","red","14px");if("CRX"==clientRunningScript)_40421d6eb1a359f2f822a28b0f0f93da0d4bbf00("no-internet");else{_cecdda69027cb5c5be0e25f2ebe66b197cc292f6();var a=$('<div id="internet-connectivity-warning" class="app-health-warning"><div class="app-health-warning-text">'+getLanguageSpecificText("offline",globalDefaultLanguage)+' <span id="check-network-connection-span-in-network-notif" class="app-health-warning-action-span"><i class="fa fa-fw fa-rotate-right"></i></span></div></div>').prependTo("body");
$(a).find("#check-network-connection-span-in-network-notif").click(function(){$(this).children(".fa").removeClass("fa-rotate-right").addClass("fa-circle-o-notch fa-spin");_86320b50d311e34a4e3016275c8461f282d87f08();_gaq.push(["_trackEvent","App-Checker","user-triggered-internet-request-from-offline-warning"])})}}
function _d8628f2c97ee9dcadb19cd0f2b86b277a73019a5(){setTimeout(function(){0<$("#check-network-connection-span-in-network-notif").length&&$("#check-network-connection-span-in-network-notif").children(".fa").removeClass("fa-circle-o-notch fa-spin").addClass("fa-rotate-right")},1500)}function _cecdda69027cb5c5be0e25f2ebe66b197cc292f6(){$.each($("#internet-connectivity-warning"),function(){$(this).remove()})}
function _63de837b18c2510e350642aa942a12a1c619a018(){if(!globalShouldPerformGlobalAppHealthCheck)return!1;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("inside of _63de837b18c2510e350642aa942a12a1c619a018, calling _61890e40034a84a1043da3ac61a0124a1a1506c9 every 30 seconds to determine user internet connectivity and stale js","purple","14px");setInterval(function(){_61890e40034a84a1043da3ac61a0124a1a1506c9()},3E4)}
function _e2740cc5aa57c15d66b867b7dfb165dd5ad7097f(a){3>a?(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("In _e2740cc5aa57c15d66b867b7dfb165dd5ad7097f count: "+a,"#419ab1","14px"),_9a0163908ce63615194f3dfea7654ade892757e4({name:"check-capi-socket-triggered-attempt-"+a.toString()}),"CRX"!=clientRunningScript?sendCAPITestMessageFromWebApp("CAPI_HEALTH_CHECK_FROM_CRX_DEC_2017"):_ff68449349c716039c3cf762d1c709202da1fcf1(),setTimeout(function(){_387abdcbaa17ad6514cbee23c8ffb6e61556d871(a)},1E4)):(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("No incoming PUSHES after 3 tries. Will reload CRX in 3 seconds",
"#419ab1","14px"),"CRX"!=clientRunningScript?(_9a0163908ce63615194f3dfea7654ade892757e4({name:"check-capi-socket-failed-3-times-reopen-socket"}),_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("In _e2740cc5aa57c15d66b867b7dfb165dd5ad7097f count > = 3.  checking internet connection then close socket","#419ab1","14px"),_6241f70323d5d16bac64e9713720689edd8c5f52(close_socket_then_channel_api_token_setup)):(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("PUSH socket unstable. Will reload CRX in 3 seconds","#419ab1",
"14px"),_9a0163908ce63615194f3dfea7654ade892757e4({name:"check-capi-socket-failed-3-times-restart-CRX"}),setTimeout(function(){_1c44fb4dd48d453d8f5dbe5e058ac3fc96cb7789("App-Health-Failed-Reestablish-CAPI")},500)))}
function _387abdcbaa17ad6514cbee23c8ffb6e61556d871(a){var b=((new Date).getTime()-global_time_last_push_rcvd.getTime())/1E3;_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Inside of _387abdcbaa17ad6514cbee23c8ffb6e61556d871.  Last PUSH received: "+b+" seconds ago.","#419ab1","14px");30>b?(_9a0163908ce63615194f3dfea7654ade892757e4({name:"check-capi-socket-is-healthy"}),___getPhoneStatus(),_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("PUSH socket is good, don't reload CRX. Make sure that the Browser Action Icon accurately reflects that the crx is STABLE and request a new phone status update.",
"green","18px")):(_5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b("Inside of _387abdcbaa17ad6514cbee23c8ffb6e61556d871.  FAILURE.","#419ab1","14px"),a++,_e2740cc5aa57c15d66b867b7dfb165dd5ad7097f(a))}function _5f4240ca7eb7e3c1748ce1230ac93093f6e54c9b(a,b,c){console.log("%c"+a,"color: "+(b?b:"blue")+";font-size: "+(c?c:"large"))}
function _9a0163908ce63615194f3dfea7654ade892757e4(a){var b=10,c="-10pct-sample",d=a.name;"CRX"==clientRunningScript&&(b=100,c="-1pct-sample");c=["_trackEvent","App-Checker",d+c];a.hasOwnProperty("label")&&c.push(a.label);5==_c74b7efa9d15c055a086e9938f6bac8ac50e9b11(0,b)&&_gaq.push(c)};